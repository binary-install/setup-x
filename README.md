# binary-install/setup-x

A GitHub Action to install binaries using [binstaller](https://github.com/binary-install/binstaller)-generated scripts with verification support.

## Features

- üîí **Secure verification** via SHA256 hash or GitHub attestations
- üì¶ **Universal compatibility** with any binstaller-generated script
- üöÄ **Automatic PATH configuration** for installed binaries
- üîç **Flexible verification options** - choose your preferred method

## Usage

### Basic Usage

```yaml
- uses: binary-install/setup-x@v1
  with:
    script_url: https://raw.githubusercontent.com/your-org/your-tool/main/install.sh
```

### With SHA256 Verification

```yaml
- uses: binary-install/setup-x@v1
  with:
    script_url: https://raw.githubusercontent.com/your-org/your-tool/main/install.sh
    script_sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
```

### With GitHub Attestations

```yaml
- uses: binary-install/setup-x@v1
  with:
    script_url: https://raw.githubusercontent.com/your-org/your-tool/main/install.sh
    gh_attestations_verify_flags: --owner your-org --repo your-tool
```

### Installing Specific Version

```yaml
- uses: binary-install/setup-x@v1
  with:
    script_url: https://raw.githubusercontent.com/your-org/your-tool/main/install.sh
    version: v1.2.3
    script_sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
```

## Inputs

| Input | Description | Required | Default |
|-------|-------------|----------|---------|
| `script_url` | URL of the binstaller-generated installation script | ‚úÖ | - |
| `script_sha256` | SHA256 hash of the installer script for verification | ‚ùå | - |
| `gh_attestations_verify_flags` | Flags for `gh attestation verify` command | ‚ùå | - |
| `version` | Version of the tool to install | ‚ùå | Script default |
| `gh_token` | GitHub token for attestation verification | ‚ùå | `${{ github.token }}` |

## Outputs

This action has no outputs. The installed binaries are automatically added to PATH.

## Examples

### Complete Workflow Example

```yaml
name: CI
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Install my-tool
        uses: binary-install/setup-x@v1
        with:
          script_url: https://raw.githubusercontent.com/my-org/my-tool/main/install.sh
          script_sha256: abc123...
      
      - name: Use my-tool
        run: my-tool --version
```

### Multi-Platform Example

```yaml
name: Test on Multiple Platforms
on: [push]

jobs:
  test:
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: binary-install/setup-x@v1
        with:
          script_url: https://raw.githubusercontent.com/my-org/my-tool/main/install.sh
          version: v2.0.0
      
      - run: my-tool --help
```

### Verifying Installation

```yaml
- name: Install tool
  uses: binary-install/setup-x@v1
  with:
    script_url: https://example.com/install.sh

- name: Verify installation
  run: |
    # The tool is now available in PATH
    my-tool --version
```

## Security Considerations

### Verification Methods

1. **SHA256 Hash** (Recommended)
   - Provide the exact SHA256 hash of the installer script
   - Fails the workflow if the hash doesn't match
   - Best for pinning to a specific script version

2. **GitHub Attestations**
   - Uses `gh attestation verify` for cryptographic verification
   - Requires the installer script to have associated attestations
   - Best for scripts with supply chain security

3. **No Verification** (Not Recommended)
   - The action will warn but continue
   - Only use for testing or trusted internal scripts

### Best Practices

- Always use verification in production workflows
- Pin to specific action versions (`@v1.2.3` instead of `@v1`)
- Review installer scripts before using them
- Use HTTPS URLs for script downloads

## How It Works

1. Downloads the binstaller-generated script from the provided URL
2. Verifies the script (if verification options provided)
3. Executes the script to install the binary
4. Adds the installation directory to PATH
5. Provides installation details as outputs

## Compatibility

- Works with any script generated by [binstaller](https://github.com/binary-install/binstaller)
- Supports Linux, macOS, and Windows runners
- Compatible with all GitHub-hosted and self-hosted runners

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.